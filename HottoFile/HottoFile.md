

---

# ğŸ“‘ é¡¹ç›®è®¾è®¡æ–‡æ¡£
1. é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ª **æ™ºèƒ½æ–‡ä»¶ç®¡ç†ä¸æ£€ç´¢ç³»ç»Ÿ**ã€‚ ç³»ç»Ÿæ”¯æŒå¯¹å¤šç±»å‹æ–‡ä»¶è¿›è¡Œè§£æã€åˆ†ç±»ã€å‘é‡åŒ–å­˜å‚¨å’Œè¯­ä¹‰æ£€ç´¢ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€æ–‡ä»¶ã€‚

é¡¹ç›®é‡‡ç”¨ **ä¸»ç³»ç»Ÿ + åˆ†ç³»ç»Ÿ** çš„åˆ†å±‚æ¶æ„ï¼š

+ **ä¸»ç³»ç»Ÿ**ï¼šè´Ÿè´£ç»Ÿä¸€è°ƒåº¦ã€æ¥å£æ•´åˆã€å¯¹å¤–æœåŠ¡
+ **åˆ†ç³»ç»Ÿ**ï¼šè´Ÿè´£å„è‡ªçš„ä»»åŠ¡ï¼ˆæ–‡ä»¶è§£æã€åˆ†ç±»ã€Embeddingã€å­˜å‚¨ã€æ£€ç´¢ç­‰ï¼‰

---

1. ç³»ç»Ÿæ¶æ„å›¾

```plain
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚      ä¸»ç³»ç»Ÿ(è°ƒåº¦)   â”‚
                â”‚  - ç›‘å¬ç›®æ ‡æ–‡ä»¶å¤¹   â”‚
                â”‚  - è°ƒç”¨å„åˆ†ç³»ç»ŸAPI â”‚
                â”‚  - æ‰§è¡Œæ–‡ä»¶ç§»åŠ¨     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                    â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–‡ä»¶ç›‘æ§å­ç³»ç»Ÿ â”‚   â”‚ é¢„å¤„ç†å­ç³»ç»Ÿ    â”‚   â”‚ Embeddingå­ç³»ç»Ÿ â”‚
â”‚ - å‘ç°æ–°æ–‡ä»¶   â”‚   â”‚ - æŠ½å–æ–‡ä»¶å    â”‚   â”‚ - ç”Ÿæˆå‘é‡ è°ƒç”¨ BGE-M3 Embedding      â”‚
â”‚ - è§¦å‘æµç¨‹     â”‚â”€â”€â–¶â”‚ - æ–‡æœ¬æ‘˜è¦      â”‚â”€â”€â–¶â”‚ - å­˜å…¥å‘é‡åº“ FAISS å‘é‡å­˜å‚¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ - å›¾åƒç‰¹å¾æå–   â”‚   â”‚ - ç›¸ä¼¼åº¦æ£€ç´¢    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚                    â”‚
                          â–¼                    â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                  â”‚ åˆ†ç±»å­ç³»ç»Ÿ      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ - æ–‡æ¡£åˆ†ç±»      â”‚
                  â”‚ - å›¾åƒåˆ†ç±»      â”‚
                  â”‚ - LLM/è§„åˆ™æ··åˆ â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ å­¦ä¹ å­ç³»ç»Ÿ      â”‚
                  â”‚ - æ¥æ”¶ç”¨æˆ·åé¦ˆ  â”‚
                  â”‚ - æ›´æ–°å‘é‡åº“    â”‚
                  â”‚ - ä¿®æ­£è§„åˆ™      â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

1. æ¨¡å—è¯´æ˜

### 3.1 ä¸»ç³»ç»Ÿ (Orchestrator)
+ **ä»»åŠ¡**
    - è°ƒç”¨åˆ†ç³»ç»Ÿæ‰§è¡Œä»»åŠ¡
    - æ¥æ”¶å¹¶æ•´åˆç»“æœ
    - é€šè¿‡ç»Ÿä¸€æ¥å£å¯¹å¤–æä¾›æœåŠ¡
+ **è¾“å…¥**
    - ç”¨æˆ·è¯·æ±‚ï¼ˆæ·»åŠ æ–‡ä»¶ / æ£€ç´¢æ–‡ä»¶ / æ›´æ–°åˆ†ç±»ï¼‰
+ **è¾“å‡º**
    - å¤„ç†ç»“æœï¼ˆæ£€ç´¢åˆ°çš„æ–‡ä»¶ / åˆ†ç±»ç»“æœ / ç³»ç»Ÿæ—¥å¿—ï¼‰

---

### 3.2 æ–‡ä»¶è§£æç³»ç»Ÿ
+ **ä»»åŠ¡**
    - è¯»å–æ–‡ä»¶ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ç­‰ï¼‰
    - æå–å†…å®¹ï¼šæ–‡æœ¬ã€OCR è¯†åˆ«ï¼ˆå›¾ç‰‡ï¼‰
    - ç”Ÿæˆç®€è¦æ‘˜è¦ï¼ˆtext_summaryï¼‰
+ **è¾“å…¥**
    - æœ¬åœ°æ–‡ä»¶è·¯å¾„
+ **è¾“å‡º**
    - `FileInfo` å¯¹è±¡ï¼ˆåŒ…å«åŸºæœ¬ä¿¡æ¯ + å†…å®¹æ‘˜è¦ï¼‰

---

### 3.3 åˆ†ç±»ç³»ç»Ÿ
åˆ†ç±»ç³»ç»Ÿç”± **ä¸‰å±‚é€»è¾‘** ç»„æˆï¼š

1. **è§„åˆ™åˆ†ç±»ï¼ˆå¿«é€Ÿåˆ¤æ–­ï¼‰**
    1. æŒ‰æ‰©å±•ååˆæ­¥åˆ†ç±»ï¼ˆä¾‹å¦‚`.pdf â†’ document`, `.jpg â†’ image`ï¼‰
2. **Embedding + æœ€è¿‘é‚»æ£€ç´¢**
    1. æ–‡ä»¶æ‘˜è¦ â†’ Embedding
    2. ä¸å·²æœ‰ç±»åˆ«å‘é‡æ¯”å¯¹ï¼Œè·å–å€™é€‰ç±»åˆ«
3. **å¤§æ¨¡å‹****åˆ†ç±»ï¼ˆ****LLM****Classifier****ï¼‰**
    1. è¾“å…¥ï¼šæ–‡ä»¶æ‘˜è¦ + å€™é€‰ç±»åˆ«
    2. è¾“å‡ºï¼šæœ€ç»ˆåˆ†ç±»ç»“æœï¼ˆå¦‚ â€œç§‘ç ”è®ºæ–‡â€ / â€œä»£ç è„šæœ¬â€ / â€œåˆåŒâ€ï¼‰

âœ… **ç‰¹ç‚¹**ï¼šEmbedding è´Ÿè´£æ‰¾å€™é€‰ç±»åˆ«ï¼Œå¦‚æœEmbeddingåˆ†ä¸äº†ï¼Œç½®ä¿¡åº¦ä¸å¤Ÿï¼ŒLLM è´Ÿè´£åšåˆ¤åˆ«ã€‚

---

### 3.4 å­¦ä¹ æ¨¡å—ï¼ˆFeedback Learningï¼‰
+ **ä»»åŠ¡**
    - ç”¨æˆ·å¦‚æœæ‰‹åŠ¨ä¿®æ­£åˆ†ç±» â†’ ç³»ç»Ÿæ›´æ–°å‘é‡æ•°æ®åº“
    - åŒæ—¶å­˜å‚¨ **ä¿®æ­£æ ·æœ¬**ï¼ˆåŸå§‹æ–‡æœ¬ + æ­£ç¡®ç±»åˆ«ï¼‰
    - å‘¨æœŸæ€§å¾®è°ƒåˆ†ç±»å™¨ / æ›´æ–° Embedding ç›¸ä¼¼åº¦æœç´¢æƒé‡
+ **è¾“å…¥**: ç”¨æˆ·ä¿®æ­£ç»“æœ
+ **è¾“å‡º**: æ›´æ–°åçš„åˆ†ç±»æ¨¡å‹ / å‘é‡åº“

---

### 3.5 å‘é‡åŒ–ä¸æ£€ç´¢ç³»ç»Ÿ
+ **ä»»åŠ¡**
    - å°†æ–‡ä»¶å†…å®¹ Embedding å­˜å…¥å‘é‡æ•°æ®åº“
    - æ”¯æŒè¯­ä¹‰æœç´¢ã€æ–‡ä»¶ç›¸ä¼¼åº¦æ£€ç´¢
+ **è¾“å…¥**: `FileInfo` æˆ– æŸ¥è¯¢æ–‡æœ¬
+ **è¾“å‡º**: ç›¸ä¼¼æ–‡ä»¶åˆ—è¡¨

---

1. **æ•°æ®ç»“æ„è®¾è®¡**

### 4.1 FileInfo ç±»
```plain
import json
import uuid
from datetime import datetime

class FileInfo:
    def __init__(self, path, name, ext, ftype, size, created_at=None, modified_at=None, 
                 text_summary=None, image_features=None, audio_transcript=None, video_keyframes=None):
        # åŸºç¡€ä¿¡æ¯
        self.file_id = str(uuid.uuid4())  # è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ID
        self.path = path
        self.name = name
        self.ext = ext
        self.type = ftype  # "document" / "image" / "audio" / "video" / "other"

        # å…ƒä¿¡æ¯
        self.metadata = {
            "size": size,
            "created_at": created_at or datetime.now().isoformat(),
            "modified_at": modified_at or datetime.now().isoformat()
        }

        # å†…å®¹
        self.content = {
            "text_summary": text_summary,
            "image_features": image_features,
            "audio_transcript": audio_transcript,
            "video_keyframes": video_keyframes
        }

        # Embedding & åˆ†ç±»ä¿¡æ¯
        self.embedding = None
        self.candidates = []
        self.final_label = None
        self.feedback = None

    # è½¬æ¢æˆå­—å…¸
    def to_dict(self):
        return {
            "file_id": self.file_id,
            "path": self.path,
            "name": self.name,
            "ext": self.ext,
            "type": self.type,
            "metadata": self.metadata,
            "content": self.content,
            "embedding": self.embedding,
            "candidates": self.candidates,
            "final_label": self.final_label,
            "feedback": self.feedback
        }

    # è½¬æ¢æˆJSON
    def to_json(self):
        return json.dumps(self.to_dict(), indent=4, ensure_ascii=False)

    # æ›´æ–°æ ‡ç­¾
    def update_label(self, label, feedback=False):
        if feedback:
            self.feedback = label
        else:
            self.final_label = label
      # å†…å®¹å­—å…¸ { "text_summary": "...", "ocr_text": "..." }
```

### 4.2 EmbeddingManager ç±»
```plain
class EmbeddingManager:
    def __init__(self, model_name="BAAI/bge-m3", device="cpu", normalize=True):
        ...
    def add_file(self, file_obj):
        ...
    def search(self, query, k=3):
        ...
    def search_file(self, file_obj, k=3):
        ...
```

---

1. å·¥ä½œæµç¨‹
2. **æ–‡ä»¶è§£æ** ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ â†’ ç³»ç»Ÿè§£æå†…å®¹ â†’ ç”Ÿæˆ `FileInfo`
3. **åˆ†ç±»** ç³»ç»Ÿè‡ªåŠ¨åˆ†ç±» â†’ ç”¨æˆ·å¯æ‰‹åŠ¨ä¿®æ­£
4. **å‘é‡åŒ–å­˜å‚¨**`FileInfo` â†’ EmbeddingManager â†’ FAISS å‘é‡åº“
5. **è¯­ä¹‰æ£€ç´¢** ç”¨æˆ·è¾“å…¥æŸ¥è¯¢ â†’ å‘é‡æœç´¢ â†’ è¿”å›æœ€ç›¸ä¼¼æ–‡ä»¶

---

1. è¿è¡Œç¯å¢ƒ
+ **è¯­è¨€**: Python 3.10+
+ **ä¸»è¦ä¾èµ–**:

```plain
pip install langchain faiss-cpu sentence-transformers transformers
pip install opencv-python pillow pytesseract  # å¦‚æœæ¶‰åŠå›¾ç‰‡OCR
```

+ **ç¡¬ä»¶ç¯å¢ƒ**:
    - CPU: Intel Ultra 7
    - GPU: æ— ï¼ˆä½¿ç”¨ CPU æ¨ç†ï¼‰

## **4.3 ****Classifier****ï¼ˆ****å¤§æ¨¡å‹****åˆ†ç±»å™¨****ï¼‰**
```plain
class LLMClassifier:
    def __init__(self, llm):
        self.llm = llm
    def classify(self, file_info, candidate_labels):
        """
        è¾“å…¥: FileInfo + å€™é€‰ç±»åˆ«
        è¾“å‡º: æœ€ç»ˆåˆ†ç±»æ ‡ç­¾
        """
```

## 4.4 FeedbackManagerï¼ˆå­¦ä¹ æ¨¡å—ï¼‰
```plain
class FeedbackManager:
    def __init__(self):
        self.corrections = []  # å­˜ç”¨æˆ·ä¿®æ­£æ•°æ®
    def add_feedback(self, file_info, correct_label):
        self.corrections.append((file_info.content, correct_label))
        # å¯é€‰: æ›´æ–° Embedding / å­˜å…¥æ•°æ®åº“
```

# å·¥ä½œæµç¨‹
1. **æ–‡ä»¶ä¸Šä¼  â†’ FileInfo è§£æ**
2. **åˆæ­¥åˆ†ç±»ï¼ˆè§„åˆ™ + Embedding å€™é€‰ï¼‰**
3. **å¤§æ¨¡å‹****åˆ†ç±» â†’ ç»™å‡ºè¯­ä¹‰æ ‡ç­¾**
4. **ç”¨æˆ·ä¿®æ­£ï¼ˆå¯é€‰ï¼‰ â†’ å­¦ä¹ æ¨¡å—æ›´æ–°**
5. **å­˜å…¥å‘é‡æ•°æ®åº“**
6. **ç”¨æˆ·æ£€ç´¢ â†’ ç›¸ä¼¼åº¦æœç´¢ + ****LLM**** è¯­ä¹‰å¢å¼º**

# è¿è¡Œç¯å¢ƒ
+ Python 3.10+
+ å¿…è¦ä¾èµ–ï¼š

```plain
pip install langchain faiss-cpu sentence-transformers transformers
pip install openai  # å¦‚æœç”¨ OpenAI æˆ–å…¶ä»– LLM
pip install opencv-python pillow pytesseract
```

---

